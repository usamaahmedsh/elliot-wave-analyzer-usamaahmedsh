# =============================================================================
# Elliott Wave Pipeline — Configuration
# =============================================================================

# =============================================================================
# PARALLELISM (unused in sequential mode — kept for reference)
# =============================================================================
ticker_workers: 62
cpu_batch_size: 4096 # irrelevant in new vectorized path, kept for compat

# top_k: how many of the ALL-options pre-scored candidates get fully evaluated
# per scan call. This is now a GLOBAL top-k (not per-batch).
# At up_to=15: 759,375 options vectorized in one numpy op, then top_k evals only.
# 300 full evals × 3 types × 8 starts × 1000 windows = 7.2M evals per ticker
# At ~3µs each = ~22s per ticker. Tractable.
cpu_top_k: 300

# Hard cap on full evals per scan call (safety net — global top-k does the real work)
max_combinations: 5000000


# =============================================================================
# SCAN DEPTH
# =============================================================================
up_to: 15 # maximum skip depth — 759,375 combos pre-scored in ~1ms

max_windows: 5000 # full 20-year history coverage (was 500 = only ~half)

top_n_per_window: 50

scan_pattern_types: all

enable_multi_start: true
max_start_points: 15 # was 20 — diminishing returns past 8, 2.5× faster


# =============================================================================
# WALL-CLOCK SAFETY NET (new knob read by scan_impulses/bearish/correctives)
# =============================================================================
# Maximum seconds allowed per individual scan call (single start point, single
# pattern type). Prevents any single window from hanging the whole run.
# At 300 top_k with ~3µs each, normal scan takes <1ms. This is a hard safety net.
max_seconds_per_scan: 10.0


# =============================================================================
# DATA RANGE
# =============================================================================
days: 7300
slide_weeks: 1
min_weeks: 8
max_weeks: 104
grow_weeks: 2
top_n: 50
delay: 0.0
concurrency: 64


# =============================================================================
# OUTPUT & MISC
# =============================================================================
out_dir: output
save_images: false
save_images_top_n: 10
analyze_patterns: false
use_shared_memory: false
chunk_size: 0
min_volatility: 0.0
skip_flat_windows: false
profile: false
window_overlap_ratio: 0.0 # no effect in sequential mode — set to 0 for clarity

pre_score_top_k: 0
pre_score_threshold: 0.0
pre_score_weights: [0.4, 0.3, 0.2, 0.1]


# =============================================================================
# MAC M4 PRO PROFILE
# =============================================================================
# cpu_top_k: 150
# max_combinations: 150
# up_to: 12
# max_windows: 500
# max_start_points: 5
# max_seconds_per_scan: 5.0
# days: 5475
# top_n: 20
# concurrency: 12
# save_images_top_n: 5


# =============================================================================
# HPC PROFILE (32 cores / 128 GB)
# =============================================================================
# cpu_top_k: 300
# max_combinations: 300
# up_to: 15
# max_windows: 1000
# max_start_points: 8
# max_seconds_per_scan: 10.0
# days: 7300
# top_n: 50
# concurrency: 32
# save_images_top_n: 10